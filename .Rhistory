library(magrittr)
library(dplyr)
keep_bcs   <- readLines("benchmark/MS_patA.tsv")
getwd()
setwd("..")
keep_bcs   <- readLines("benchmark/MS_patA.tsv")
anno       <- read.csv("benchmark/RNA_cellannot_patA.csv",
header=TRUE,
stringsAsFactors=FALSE)
normal_RNA <- anno$X[anno$cell_type != "malignant_B"]
tumor_RNA <- anno %>%
filter((cell_type=="malignant_B") &
(X %in% keep_bcs)) %>%
pull(X)
tumor_RNA
library(Seurat)
library(GenomicRanges)
library(purrr)
library(magrittr)
library(dplyr)
seu <- readRDS("benchmark/patA.rds")
keep_bcs   <- readLines("benchmark/MS_patA.tsv")
anno       <- read.csv("benchmark/RNA_cellannot_patA.csv",
header=TRUE,
stringsAsFactors=FALSE)
normal_RNA <- anno$X[anno$cell_type != "malignant_B"]
tumor_RNA <- anno %>%
filter((cell_type=="malignant_B") &
(X %in% keep_bcs)) %>%
pull(X)
seu <- subset(seu, cells=c(normal_RNA,tumor_RNA))
seu
normal_RNA
tumor_RNA
